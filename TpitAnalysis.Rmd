---
title: "TpitReport"
author: "W. McDonald"
date: "2/24/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Goal

The goal of this document is to reproducibly import, wrangle and analyse the full pituitary adenoma tissue microarray dataset, including all immunostains up to *Tpit*. *CAM5.2* staining pattern is included, as a relavant categorical variable. Otherwise, IHC staining extant and intensity are reported as Allred scores as previously published. 

This analysis will rely on the tools of the tidyverse, when possible. 

## Data import, wrangling.

```{r}
library(tidyverse)
patma <- read_csv("data/TpitAddedDx")

patma %>%
  count(newDx, sort = TRUE)

patma %>%
  group_by(newDx) %>%
  summarize(mean(TSHMedian, na.rm = TRUE))
```

## IHC by diagnosis box plots, scatter plots

A basic understanding of the staining patterns is an important first step. 

```{r}
g<-ggplot(patma, aes(newDx, TPITMedian))
g + geom_point(position=position_jitter(width=0.3, height=0.1)) +
  theme_minimal() +
  coord_flip() +
  labs(x="Diagnostic Class") +
  labs(y="Allred Score") +
  labs(title="Tpit Median IHC Score")

t<-ggplot(patma, aes(newDx, TSHMedian))
t + geom_point(position=position_jitter(width=0.3, height=0.1)) +
  theme_minimal() +
  coord_flip() +
  labs(x="Diagnostic Class") +
  labs(y="Allred Score") +
  labs(title="TSH Median IHC Score")


```


## Correlation matrix and p values for the correlations

```{r}

```

## HIERARCHICAL CLUSTERING

```{r}

```

## K-means cluster analysis and display using clusplot()

```{r}

```

## PRINCIPLE COMPONENT ANALYSIS (PCA)
```{r}

```

## FACTOR ANALYSIS
```{r}

```

## Classification trees

```{r}

```


